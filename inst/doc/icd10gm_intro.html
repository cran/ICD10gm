<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ewan Donnachie" />

<meta name="date" content="2019-08-21" />

<title>Introduction to the ICD10gm Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the ICD10gm Package</h1>
<h3 class="subtitle">Motivation, Basic Usage and Examples</h3>
<h4 class="author">Ewan Donnachie</h4>
<h4 class="date">2019-08-21</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>ICD10gm is an R Package for working with the German Modification of the International Statistical Classification of Diseases and Related Health Problems (ICD-10-GM).</p>
<p>The ICD-10 classification is an international standard for the coding of health service data. It is used widely both to document morbidity in healthcare systems, usually in the context of remuneration claims, and to encode <a href="http://www.who.int/healthinfo/mortality_data/en/">mortality statistics</a>. In Germany, the <a href="https://www.dimdi.de">German Instutite of Medical Documentation and Information (DIMDI)</a> releases a German Modification (ICD-10-GM) of the classification that forms a compulsory part of all remuneration claims in the ambulatory and hospital sectors. Further information and historical context can be found in, for example, <a href="https://doi.org/10.1007/s00103-007-0283-x">Graubner (2007)</a> or <a href="https://www.jstor.org/stable/25767019">Jetté <em>et al</em> (2010)</a>.</p>
<div id="aims" class="section level2">
<h2>Aims</h2>
<p>This package was created to facilitate the analysis of data coded using the ICD-10-GM. In particular, it has the following aims:</p>
<ol style="list-style-type: decimal">
<li>Provide convenient access to the extended ICD-10-GM metadata</li>
<li>Identify and extract ICD-10 codes from character strings</li>
<li>Facilitate the specification of ICD codes for analysis, utilising the ICD hierarchy (e.g. given the specification “A0” return all subcodes in the range “A01” to “A09”)</li>
<li>Enable the historization of ICD specifications when analysing longitudinal claims data, applying the automatic code transitions provided by DIMDI, identifying potentially problematic codes and enabling the specification of custom transitions</li>
</ol>
<p>ICD10gm is designed for use in the context of medical and health services research using routinely collected claims data. It is not suitable for use in operative coding as it does not include all relevant metadata (e.g. inclusion and exclusion notes and the detailed definitions of psychiatric diagnoses). The metadata provided in the ICD10gm package is not intended to replace the <a href="https://www.dimdi.de/dynamic/de/klassifikationen/icd/icd-10-gm/">official DIMDI documentation</a>, which should always be consulted when specifying ICD codes for analysis.</p>
<p>The following presents an overview of the basic functionality provided by the ICD10gm package, illustrated by means of simple examples. To access this vignette in R, type:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">vignette</span>(<span class="st">&quot;icd10gm_intro&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;ICD10gm&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="basic-use" class="section level1">
<h1>Basic Use</h1>
<div id="access-icd-10-gm-metadata" class="section level2">
<h2>Access ICD-10-GM metadata</h2>
<p>The ICD-10-GM metadata are provided by four data.frames that form the core of the ICD10gm package:</p>
<ul>
<li><code>icd_meta_chapters</code>: Specification of the ICD-10-GM chapters with label and number (Arabic and Roman numerals)</li>
<li><code>icd_meta_blocks</code>: Specification of the ICD-10 blocks, each containing a sequence of related ICD-10 codes</li>
<li><code>icd_meta_codes</code>: Extended metadata for all ICD-10-GM codes</li>
<li><code>icd_meta_transitions</code>: The “crosswalk” table specifying old and new ICD-10-GM codes for successive annual versions.</li>
</ul>
<p>Documentation for the individual datasets can be accessed using the R help system by typing, for example, either <code>help(&quot;icd_meta_codes&quot;, package = &quot;ICD10gm&quot;)</code> or simply <code>?icd_meta_codes</code>.</p>
<p>While column names have been translated into English, the ICD-10-GM labels are in German with UTF-8 character encoding throughout.</p>
<p>In addition to this tabular data, several utility functions are provided to perform common queries on the metadata:</p>
<ul>
<li><code>get_icd_labels</code> queries <code>icd_meta_codes</code> and returns only the ICD subcodes and labels for specified codes and years.</li>
<li><code>get_icd_history</code> queries <code>icd_meta_transitions</code> and returns only the mappings for specified codes and years.</li>
<li><code>icd_showchanges</code> and <code>icd_showchanges_icd3</code> query <code>icd_meta_transitions</code> and return entries that are affected by changes in the ICD-10-GM versions.</li>
</ul>
<div id="example" class="section level3">
<h3>Example</h3>
<p>First, we load the ICD10gm package alongside some <a href="https://tidyverse.org">tidyverse packages</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(ICD10gm)</a></code></pre></div>
<p>By way of example, we examine the coding of unspecific gastroenteritis (i.e. without identification of a specific cause), a very common diagnosis in primary care. This is currently classified under the ICD-10 code “A09”, which we can lookup for the year 2018 as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">get_icd_labels</span>(<span class="st">&quot;A09&quot;</span>, <span class="dt">year =</span> <span class="dv">2018</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="left">icd3</th>
<th align="left">icd_code</th>
<th align="left">icd_normcode</th>
<th align="left">icd_sub</th>
<th align="left">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2018</td>
<td align="left">A09</td>
<td align="left">A09.-</td>
<td align="left">A09</td>
<td align="left">A09</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis infektiösen und nicht näher bezeichneten Ursprungs</td>
</tr>
<tr class="even">
<td align="right">2018</td>
<td align="left">A09</td>
<td align="left">A09.0</td>
<td align="left">A09.0</td>
<td align="left">A090</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis infektiösen Ursprungs</td>
</tr>
<tr class="odd">
<td align="right">2018</td>
<td align="left">A09</td>
<td align="left">A09.9</td>
<td align="left">A09.9</td>
<td align="left">A099</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis nicht näher bezeichneten Ursprungs</td>
</tr>
</tbody>
</table>
<p>Now, we check whether whether this code has been affected by code transitions in any revision since 2003:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">icd_showchanges_icd3</span>(<span class="st">&quot;A09&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">year_from</th>
<th align="right">year_to</th>
<th align="left">icd_from</th>
<th align="left">icd_to</th>
<th align="left">automatic_forward</th>
<th align="left">automatic_backward</th>
<th align="left">change_5</th>
<th align="left">change_4</th>
<th align="left">change_3</th>
<th align="left">change</th>
<th align="left">icd3</th>
<th align="left">icd_kapitel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2009</td>
<td align="right">2010</td>
<td align="left">A09</td>
<td align="left">A09.0</td>
<td align="left"></td>
<td align="left">A</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">A09</td>
<td align="left">A</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="right">2010</td>
<td align="left">A09</td>
<td align="left">A09.9</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">A09</td>
<td align="left">A</td>
</tr>
<tr class="odd">
<td align="right">2009</td>
<td align="right">2010</td>
<td align="left">K52.9</td>
<td align="left">A09.9</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">A09</td>
<td align="left">A</td>
</tr>
</tbody>
</table>
<p>Diagnoses that, prior to 2009, were coded as K52.9 are now coded as A09.9. We can investigate exactly what changed by looking the relevant codes for the years 2009 and 2010:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">get_icd_labels</span>(<span class="dt">icd3 =</span> <span class="kw">c</span>(<span class="st">&quot;A09&quot;</span>, <span class="st">&quot;K52&quot;</span>), <span class="dt">year =</span> <span class="dv">2009</span><span class="op">:</span><span class="dv">2010</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(year, icd_sub) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(icd_sub <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;K529&quot;</span>) <span class="op">|</span><span class="st"> </span>icd3 <span class="op">==</span><span class="st"> &quot;A09&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(year, icd_normcode, label) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="left">icd_normcode</th>
<th align="left">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2009</td>
<td align="left">A09</td>
<td align="left">Diarrhoe und Gastroenteritis, vermutlich infektiösen Ursprungs</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="left">K52.9</td>
<td align="left">Nichtinfektiöse Gastroenteritis und Kolitis, nicht näher bezeichnet</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">A09</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis infektiösen und nicht näher bezeichneten Ursprungs</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">A09.0</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis infektiösen Ursprungs</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">A09.9</td>
<td align="left">Sonstige und nicht näher bezeichnete Gastroenteritis und Kolitis nicht näher bezeichneten Ursprungs</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">K52.9</td>
<td align="left">Nichtinfektiöse Gastroenteritis und Kolitis, nicht näher bezeichnet</td>
</tr>
</tbody>
</table>
<p>Prior to 2010, A09 had been reserved for gastroenteritis of presumed infectious origin (German: <em>vermutlich infektiösen Ursprungs</em>), with unspecified gastroenteritis coded by K52.9. Since 2010, A09.9 codes any unspecified gastroenteritis, with K52.9 reserved for cases determined to be non-infectious. The effect of this change is that A09.9 has replaced K52.9 as the unspecific code used to document the vast majority of routine cases in primary care. Failure to account for this would constitute a major error in medical or epidemiological research.</p>
</div>
</div>
<div id="test-whether-a-string-represents-an-icd-10-gm-code" class="section level2">
<h2>Test whether a string represents an ICD-10-GM code</h2>
<p>The function <code>is_icd_code</code> tests whether a character vector represents a valid ICD-10-GM code (i.e. a code listed in the data.frame <code>icd_meta_codes</code>, allowing for alternative code specifications). The test may be limited to a particular version of the ICD-10-GM by specifying the <code>year</code> argument.</p>
<div id="examples" class="section level3">
<h3>Examples</h3>
<p>The function <code>is_icd_code</code> recognises ICD codes regardless of their formatting, returning <code>TRUE</code> if the string is recognised as an ICD code and <code>FALSE</code> otherwise:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">is_icd_code</span>(<span class="kw">c</span>(<span class="st">&quot;E10.1&quot;</span>, <span class="st">&quot;E101&quot;</span>, <span class="st">&quot;E10.1-&quot;</span>, <span class="st">&quot;J44&quot;</span>, <span class="st">&quot;This is not an ICD code&quot;</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1]  TRUE  TRUE  TRUE  TRUE FALSE</span></a></code></pre></div>
</div>
</div>
<div id="extracting-icd-codes-from-a-string" class="section level2">
<h2>Extracting ICD codes from a string</h2>
<p>The function <code>icd_parse</code> extracts all ICD-10 codes from an arbitrary character vector. On the one hand, this may be used as in the <code>icd_expand</code> function to convert ICD-10 codes to a standardised format or extract parts of the code. On the other hand, it may be used to extract potentially many ICD-10 codes from any document that can be converted to text format (perhaps using the <a href="https://CRAN.R-project.org/package=pdftools"><code>pdftools</code> package</a> to scrape a PDF document or <a href="https://CRAN.R-project.org/package=rvest"><code>rvest</code></a> to scrape a website).</p>
<div id="example-scraping-codes-from-a-website" class="section level3">
<h3>Example: Scraping codes from a website</h3>
<p>As an example of how ICD10gm can be used to extract ICD codes from arbitrary text, the following code uses the rvest package to scrape the code block “A00-A09” from the online version of the DIMDI ICD-10-GM reference. We apply the filter to exclude codes below A10, thus revealing which other ICD-10 codes are reference from this block. To simply the package building process, the code has not been evaluated. This is left as an exercise to the reader.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(rvest)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">read_html</span>(<span class="st">&quot;https://www.dimdi.de/static/de/klassifikationen/icd/icd-10-gm/kode-suche/htmlgm2018/block-a00-a09.htm&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">  </span><span class="kw">html_text</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">icd_parse</span>(<span class="dt">type =</span> <span class="st">&quot;bounded&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>icd_spec) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="st">  </span><span class="kw">unique</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="st">  </span><span class="kw">filter</span>(icd_sub <span class="op">&gt;=</span><span class="st"> &quot;A10&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="st">  </span><span class="kw">arrange</span>(icd_sub) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    <span class="kw">get_icd_labels</span>(<span class="dt">year =</span> <span class="dv">2018</span>)[, <span class="kw">c</span>(<span class="st">&quot;icd_sub&quot;</span>, <span class="st">&quot;icd_normcode&quot;</span>, <span class="st">&quot;label&quot;</span>)],</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">    <span class="dt">by =</span> <span class="st">&quot;icd_sub&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw">select</span>(icd_normcode, label) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">row.names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">               <span class="dt">caption =</span> <span class="st">&quot;Additional ICD-10 codes referred to in block A00-A09 (Intestional infectious diseases) of the ICD-10-GM (2018).&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="expand-a-icd-specification-down-the-hierarchy" class="section level2">
<h2>Expand a ICD specification down the hierarchy</h2>
<p>The function <code>icd_expand</code> takes a data.frame containing ICD codes and optional metadata as input. It returns a data.frame containing all ICD codes at or below the specified level of the hierarchy (e.g. the specification “E11” is expanded to include all three, four and five-digit codes beginning with E11). Expansion is done within a specified version of the ICD-10-GM (e.g. year 2018).</p>
<div id="example-1" class="section level3">
<h3>Example</h3>
<p>Irritable bowel syndrome is coded using either the three-digit code K58 (conceiving IBS as the somatic condition) or the code F45.32 (focussing on IBS as a psychosomatic condition). We can retrieve all subcodes in the year 2019 as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">icd_k58 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DIAG_GROUP =</span> <span class="kw">c</span>(<span class="st">&quot;IBS&quot;</span>, <span class="st">&quot;IBS&quot;</span>), <span class="dt">ICD_SPEC =</span> <span class="kw">c</span>(<span class="st">&quot;K58&quot;</span>, <span class="st">&quot;F45.32&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">icd_expand</span>(<span class="dt">col_icd =</span> <span class="st">&quot;ICD_SPEC&quot;</span>, <span class="dt">year =</span> <span class="dv">2019</span>, <span class="dt">col_meta =</span> <span class="st">&quot;DIAG_GROUP&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">knitr<span class="op">::</span><span class="kw">kable</span>(icd_k58)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">icd_spec</th>
<th align="left">DIAG_GROUP</th>
<th align="right">year</th>
<th align="left">icd3</th>
<th align="left">icd_code</th>
<th align="left">icd_normcode</th>
<th align="left">icd_sub</th>
<th align="left">label</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">K58</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">K58</td>
<td align="left">K58.-</td>
<td align="left">K58</td>
<td align="left">K58</td>
<td align="left">Reizdarmsyndrom</td>
</tr>
<tr class="even">
<td align="left">K58</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">K58</td>
<td align="left">K58.1</td>
<td align="left">K58.1</td>
<td align="left">K581</td>
<td align="left">Reizdarmsyndrom, Diarrhoe-prädominant [RDS-D]</td>
</tr>
<tr class="odd">
<td align="left">K58</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">K58</td>
<td align="left">K58.2</td>
<td align="left">K58.2</td>
<td align="left">K582</td>
<td align="left">Reizdarmsyndrom, Obstipations-prädominant [RDS-O]</td>
</tr>
<tr class="even">
<td align="left">K58</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">K58</td>
<td align="left">K58.3</td>
<td align="left">K58.3</td>
<td align="left">K583</td>
<td align="left">Reizdarmsyndrom mit wechselnden (gemischten) Stuhlgewohnheiten [RDS-M]</td>
</tr>
<tr class="odd">
<td align="left">K58</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">K58</td>
<td align="left">K58.8</td>
<td align="left">K58.8</td>
<td align="left">K588</td>
<td align="left">Sonstiges und nicht näher bezeichnetes Reizdarmsyndrom</td>
</tr>
<tr class="even">
<td align="left">F4532</td>
<td align="left">IBS</td>
<td align="right">2019</td>
<td align="left">F45</td>
<td align="left">F45.32</td>
<td align="left">F45.32</td>
<td align="left">F4532</td>
<td align="left">Somatoforme autonome Funktionsstörung: Unteres Verdauungssystem</td>
</tr>
</tbody>
</table>
<p>Note that the <code>data.frame</code> containing the specification should normally be stored as a separate metadata file (eg. csv or Excel format) to facilitate maintenance and sharing of the specification. The column <code>DIAG_GROUP</code> is a label that can be allocated to one or multiple rows of the specification and is useful when aggregating diagnoses. This is similar to the concept of diagnosis groupers used, for example, in risk adjustment schemes (e.g. as operated by the <a href="https://www.bundesversicherungsamt.de/risikostrukturausgleich.html">German Federal Social Insurance Office</a>). In this case, we may want to treat the two alternative codes as equivalent by allocating the label “IBS” to both. In this way, we overcome the common problem that, in practice, multiple codes are used to document the same underlying disease.</p>
</div>
</div>
<div id="historise-an-icd-specification" class="section level2">
<h2>Historise an ICD specification</h2>
<p>The function <code>icd_history</code> takes the result of <code>icd_expand</code>, specified for a particular year, and returns a data.frame containing all corresponding codes for the specified years (from 2003). To do this, it applies the ICD-10-GM transition tables to map codes between successive ICD-10-GM versions. Only automatic transitions are followed to ensure that the specification retains its meaning. Custom transitions, tailored to the needs of the project at hand, can be specified to yield a more complete history.</p>
</div>
<div id="example-2" class="section level2">
<h2>Example</h2>
<p>We historise the code K58, specified for the year 2019, backwards to obtain the corresponding codes for the years 2017 to 2019:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">icd_history</span>(icd_k58, <span class="dt">years =</span> <span class="dv">2017</span><span class="op">:</span><span class="dv">2019</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(icd_spec, DIAG_GROUP, year, icd_code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">arrange</span>(year, icd_code)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;    icd_spec DIAG_GROUP  year icd_code</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;    &lt;fct&gt;      &lt;int&gt; &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;  1 F4532    IBS         2017 F45.32  </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt;  2 K58      IBS         2017 K58.0   </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;  3 K58      IBS         2017 K58.9   </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;  4 F4532    IBS         2018 F45.32  </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;  5 K58      IBS         2018 K58.0   </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt;  6 K58      IBS         2018 K58.9   </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt;  7 F4532    IBS         2019 F45.32  </span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt;  8 K58      IBS         2019 K58.-   </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt;  9 K58      IBS         2019 K58.1   </span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; 10 K58      IBS         2019 K58.2   </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; 11 K58      IBS         2019 K58.3   </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; 12 K58      IBS         2019 K58.8</span></a></code></pre></div>
</div>
</div>
<div id="copyright" class="section level1">
<h1>Copyright</h1>
<p>Program code is released under the <a href="https://edonnachie.github.io/ICD10gm/LICENSE-text.html">MIT license</a>.</p>
<p>The underlying ICD-10-GM metadata is copyright of the <a href="https://www.dimdi.de">German Instutite of Medical Documentation and Information (DIMDI)</a>. The source files are available free of charge from the <a href="https://www.dimdi.de/dynamic/de/klassifikationen/downloads/?dir=icd-10-gm">DIMDI Download Centre</a>. I believe that their use in this package is compatible with the copyright restrictions. In particular:</p>
<ul>
<li><p>The distribution of an “added-value product” derived from the original DIMDI classification files is expressly permitted.</p></li>
<li><p>Distribution of the original classification files is forbidden. Consequently, this package distributes only the code required to process these files. Those wishing to compile the data from scratch must download the files from the DIMDI download centre and agree to the copyright restrictions.</p></li>
<li><p>The package does not modify the ICD-10-GM codes, texts or other metadata in any way other than to restructure the data into a convenient form.</p></li>
<li><p>The package does not contain any commercial advertising.</p></li>
<li><p>The source of the data is clearly stated, both here and in the main package documentation.</p></li>
</ul>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>The ICD10gm package provides a convenient means of accessing and manipulating the German modification of the ICD-10 classification. It is designed for use in medical, epidemiological and health services research.</p>
<p>To the author’s knowledge, this package represents the only publicly available repository of pre-processed metadata for the ICD-10-GM. Indeed, a key contribution of the package is the compilation and processing of the metadata provided by DIMDI, which is designed more for the needs of operational use than for the purpose of longitudinal secondary data analysis.</p>
<p>Building on the metadata, the ICD10gm package provides various functions to facilitate the analysis of ICD-10 data. Possible uses include:</p>
<ul>
<li><p>Calculating the administrative prevalence of diseases over time, accounting for changes to the ICD-10-GM classification.</p></li>
<li><p>The extraction of ICD-10 codes for the purposes of text mining.</p></li>
<li><p>The implementation of diagnoses grouping systems for the representation of patient morbidity.</p></li>
</ul>
<div id="related-packages" class="section level2">
<h2>Related Packages</h2>
<p>The <a href="https://CRAN.R-project.org/package=icd">icd package</a> has similar aims but has a slightly different approach and focusses on the US version of the ICD-10 system.</p>
</div>
<div id="cite" class="section level2">
<h2>Cite</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">citation</span>(<span class="dt">package =</span> <span class="st">&quot;ICD10gm&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; To cite package 'ICD10gm' in publications use:</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;   Ewan Donnachie (2019). ICD10gm: Metadata Processing for the</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;   German Modification of the ICD-10 Coding System.</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;   https://github.com/edonnachie/ICD10gm,</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;   https://doi.org/10.5281/zenodo.2542833.</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;   @Manual{,</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;     title = {ICD10gm: Metadata Processing for the German Modification of the ICD-10 Coding System},</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;     author = {Ewan Donnachie},</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;     year = {2019},</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;     note = {https://github.com/edonnachie/ICD10gm, https://doi.org/10.5281/zenodo.2542833},</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;   }</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
